<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tr√°i Tim & Ph√°o Hoa üíñüéÜ</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: radial-gradient(circle at center, #190015, #000);
      overflow: hidden;
    }
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      display: block;
      filter: blur(0.3px);
    }
  </style>
</head>
<body>
  <!-- Canvas cho ph√°o hoa -->
  <canvas id="fireworks"></canvas>
  <!-- Canvas cho tr√°i tim -->
  <canvas id="heart"></canvas>

  <script>
    // ======= C√ÄI ƒê·∫∂T CHUNG =======
    const heartCanvas = document.getElementById("heart");
    const fireCanvas = document.getElementById("fireworks");
    const ctx = heartCanvas.getContext("2d");
    const fctx = fireCanvas.getContext("2d");
    let W, H;

    function resize() {
      W = heartCanvas.width = fireCanvas.width = window.innerWidth;
      H = heartCanvas.height = fireCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    // ======= CLASS PARTICLE TR√ÅI TIM =======
    class Particle {
      constructor(x, y, size, color, angle, radius) {
        this.x = x;
        this.y = y;
        this.size = size;
        this.color = color;
        this.angle = angle;
        this.radius = radius;
        this.life = 0;
      }
      update() {
        this.life += 0.02;
        this.x += Math.cos(this.angle) * this.radius * 0.05;
        this.y += Math.sin(this.angle) * this.radius * 0.05;
        this.size *= 0.98;
        this.radius *= 1.03;
      }
      draw() {
        const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size * 3);
        gradient.addColorStop(0, this.color);
        gradient.addColorStop(1, "rgba(255, 0, 100, 0)");
        ctx.beginPath();
        ctx.fillStyle = gradient;
        ctx.globalAlpha = Math.max(0, 1 - this.life / 3);
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    // ======= H·∫†T PH√ÅO HOA =======
    class Firework {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.particles = [];
        for (let i = 0; i < 40; i++) {
          this.particles.push({
            x: x,
            y: y,
            angle: Math.random() * Math.PI * 2,
            speed: Math.random() * 3 + 1,
            life: Math.random() * 50 + 50,
          });
        }
      }
      update() {
        this.particles.forEach(p => {
          p.x += Math.cos(p.angle) * p.speed;
          p.y += Math.sin(p.angle) * p.speed;
          p.speed *= 0.96;
          p.life -= 1;
        });
        this.particles = this.particles.filter(p => p.life > 0);
      }
      draw() {
        this.particles.forEach(p => {
          fctx.beginPath();
          fctx.fillStyle = this.color;
          fctx.globalAlpha = p.life / 100;
          fctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
          fctx.fill();
        });
      }
    }

    const particles = [];
    const fireworks = [];
    let t = 0;
    let beatSpeed = 0.04;

    // ======= H√ÄM TR√ÅI TIM =======
    function heartFunction(angle) {
      const x = 16 * Math.pow(Math.sin(angle), 3);
      const y =
        13 * Math.cos(angle) -
        5 * Math.cos(2 * angle) -
        2 * Math.cos(3 * angle) -
        Math.cos(4 * angle);
      return { x, y };
    }

    function createHeart(scale = 15) {
      for (let i = 0; i < 80; i++) {
        const angle = Math.random() * 2 * Math.PI;
        const h = heartFunction(angle);
        const x = W / 2 + h.x * scale;
        const y = H / 2 - h.y * scale;
        const color = `hsl(${Math.random() * 15 + 330}, 100%, ${
          Math.random() * 20 + 65
        }%)`;
        particles.push(
          new Particle(
            x,
            y,
            Math.random() * 3 + 1.5,
            color,
            Math.random() * 2 * Math.PI,
            Math.random() * 3 + 1
          )
        );
      }
    }

    function drawMainHeart(scale) {
      ctx.save();
      ctx.translate(W / 2, H / 2);
      ctx.scale(scale, scale);
      ctx.beginPath();
      ctx.moveTo(0, -13);
      for (let i = 0; i < 2 * Math.PI; i += 0.05) {
        const h = heartFunction(i);
        ctx.lineTo(h.x, -h.y);
      }
      ctx.closePath();
      const gradient = ctx.createRadialGradient(0, 0, 0, 0, 0, 20);
      gradient.addColorStop(0, "rgba(255, 100, 150, 0.9)");
      gradient.addColorStop(1, "rgba(255, 0, 100, 0.2)");
      ctx.fillStyle = gradient;
      ctx.shadowBlur = 30;
      ctx.shadowColor = "rgba(255, 60, 150, 0.7)";
      ctx.fill();
      ctx.restore();
    }

    // ======= PH√ÅO HOA NG·∫™U NHI√äN =======
    function createFirework() {
      const x = Math.random() * W;
      const y = Math.random() * (H / 2);
      const color = `hsl(${Math.random() * 360}, 100%, 60%)`;
      fireworks.push(new Firework(x, y, color));
    }

    // ======= V√íNG L·∫∂P ANIMATION =======
    function animate() {
      // N·ªÅn m·ªù d·∫ßn ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng chuy·ªÉn ƒë·ªông m∆∞·ª£t
      ctx.fillStyle = "rgba(0,0,0,0.25)";
      ctx.fillRect(0, 0, W, H);
      fctx.fillStyle = "rgba(0,0,0,0.2)";
      fctx.fillRect(0, 0, W, H);

      // C·∫≠p nh·∫≠t tim
      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.update();
        p.draw();
        if (p.size < 0.3) particles.splice(i, 1);
      }

      t += beatSpeed;
      const beat = 1 + Math.sin(t * 2) * 0.05;
      drawMainHeart(beat);

      // Lan t·ªèa h·∫°t tim
      if (Math.sin(t * 2) > 0.9) createHeart(15 + Math.sin(t) * 2);

      // T·∫°o ph√°o hoa ng·∫´u nhi√™n
      if (Math.random() < 0.03) createFirework();

      // C·∫≠p nh·∫≠t ph√°o hoa
      for (let i = fireworks.length - 1; i >= 0; i--) {
        const f = fireworks[i];
        f.update();
        f.draw();
        if (f.particles.length === 0) fireworks.splice(i, 1);
      }

      requestAnimationFrame(animate);
    }

    animate();
  </script>
</body>
</html>
